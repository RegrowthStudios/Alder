{{ extends "base.twig" }}

{% set tables = true %}

{% block page_title %}Installer - Overview{% endblock %}
{% block page_description %}Overview of the installation process to be performed.{% endblock %}
{% block head %}
  {{ parent() }}
    <link href="./css/install.css" rel="stylesheet" />
{% endblock %}
{% block content %}
      <div id="page-wrapper">
        <div class="row">
          <div class="col-lg-12">
            <h1 class="page-header">Alder Installer</h1>
          </div>
          <!-- /.col-lg-12 -->
        </div>
        <!-- /.row -->
        <div class="row">
          <div class="col-lg-12">
            <ul class="breadcrumb install-breadcrumb">
              <li class="current">Overview</li>
              <li>Config</li>
              <li>Database</li>
              <li>Tasks</li>
            </ul>
            <!-- /.install-breadcrumb -->
          </div>
          <!-- /.col-lg-12 -->
        </div>
        <!-- /.row -->
  {% if no_pending_installs is defined %}
        <div class="row">
          <div class="col">
            <div class="panel panel-yellow">
              <a href="/admin">
                <div class="panel-heading">
                  <div class="row">
                    <div class="col-xs-3">
                      <i class="fa fa-wrench fa-5x"></i>
                    </div>
                    <div class="col-xs-9 text-right">
                      <div class="big">There's nothing to be installed!</div>
                    </div>
                  </div>
                </div>
                <div class="panel-footer">
                  <span class="pull-left">Go back...</span>
                  <span class="pull-right"><i class="fa fa-arrow-circle-right"></i></span>
                  <div class="clearfix"></div>
                </div>
              </a>
            </div>
          </div>
          <!-- /.col -->
        </div>
        <!-- /.row -->
  {% elseif dependency_evaluations is defined %}
        <div class="row">
          <div class="col-lg-12">
            <div class="panel panel-default">
              <div class="panel-heading">
                  <p>Unsatisfied Dependencies</p>
              </div>
              <!-- /.panel-heading -->
              <div class="panel-body">
                <table width="100%" class="table table-striped table-bordered table-hover" id="dependency-table">
                  <thead>
                    <tr>
                      <th></th>
                      <th>Name</th>
                      <th>Author</th>
                      <th>Version Constraint</th>
                      <th>Old Version</th>
                      <th>New Version</th>
                    </tr>
                  </thead>
                  <tbody>
                    {% for module in modules %}
                    <tr>
                      {% if module.url is defined %}
                      <td><a href="{{ module.url }}">{{ module.name }}</a></td>
                      {% else %}
                      <td>{{ module.name }}</td>
                      {% endif %}
                      <td>{{ module.old_version }}</td>
                      <td>{{ module.new_version }}</td>
                      {% if module.author_url is defined %}
                      <td><a href="{{ module.author_url }}">{{ module.author }}</a></td>
                      {% else %}
                      <td>{{ module.author }}</td>
                      {% endif %}
                    </tr>
                    {% endfor %}
                  </tbody>
                </table>
                <!-- /.table-responsive -->
                <div class="well">
                  <h4>Not all dependencies are satisfied.</h4>
                  <p>Either remove the modules missing their dependencies or provide the dependencies.</p>
                </div>
              </div>
              <!-- /.panel-body -->
            </div>
            <!-- /.panel -->
          </div>
          <!-- /.col-lg-12 -->
        </div>
        <!-- /.row -->
  {% else %}
        <div class="row">
          <div class="col-lg-12">
            <div class="panel panel-default">
              <div class="panel-heading">
                  <p>Pending Modules</p>
              </div>
              <!-- /.panel-heading -->
              <div class="panel-body">
                <table width="100%" class="table table-striped table-bordered table-hover" id="dataTables-example">
                  <thead>
                    <tr>
                      <th>Name</th>
                      <th>Old Version</th>
                      <th>New Version</th>
                      <th>Author</th>
                    </tr>
                  </thead>
                  <tbody>
                    {% for module in modules %}
                    <tr>
                      {% if module.url is defined %}
                      <td><a href="{{ module.url }}">{{ module.name }}</a></td>
                      {% else %}
                      <td>{{ module.name }}</td>
                      {% endif %}
                      <td>{{ module.old_version }}</td>
                      <td>{{ module.new_version }}</td>
                      {% if module.author_url is defined %}
                      <td><a href="{{ module.author_url }}">{{ module.author }}</a></td>
                      {% else %}
                      <td>{{ module.author }}</td>
                      {% endif %}
                    </tr>
                    {% endfor %}
                  </tbody>
                </table>
                <!-- /.table-responsive -->
                <div class="well">
                  <h4>Proceed with installation?</h4>
                  <p>Once you're happy with the pending modules, hit the install button and we'll begin the installation procedure!</p>
                  <a class="btn btn-success btn-lg btn-block" href="#">Install!</a>
                </div>
              </div>
              <!-- /.panel-body -->
            </div>
            <!-- /.panel -->
          </div>
          <!-- /.col-lg-12 -->
        </div>
        <!-- /.row -->
  {% endif %}
      </div>
      <!-- /#page-wrapper -->
{% endblock %}
{% block global_content %}
    <!-- Confirm Leave Page Modal -->
    <div class="modal fade" id="leave-confirm-modal" role="dialog">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal">&times;</button>
            <h4 class="modal-title">Confirmation</h4>
          </div>
          <div class="modal-body">
            <p>Are you sure you wish to exit the installation process?<br />Progress thus far will be lost.</p>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">No</button>
            <button type="button" class="btn btn-danger" id="leave" data-dismiss="modal">Yes</button>
          </div>
        </div>
      </div>
    </div>
{% endblock %}
{% block foot %}
    {{ parent() }}
    <script src="./js/disable_side_menu.js"></script>
    <script src="./js/install.js"></script>
    <script src="./js/install_overview.js"></script>
{% endblock %}
